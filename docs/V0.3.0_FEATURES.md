# Accelerapp v0.3.0 Features

This document describes the new features introduced in version 0.3.0.

## Overview

Version 0.3.0 introduces foundational architectures for four major feature areas:
- Cloud-based generation service
- Template marketplace
- Visual specification builder
- Hardware-in-the-loop testing

These features provide the core modules and interfaces that can be extended for full production deployment.

## Cloud Generation Service

Located in `src/accelerapp/cloud/`

### Components

#### CloudGenerationService
Main orchestrator for distributed code generation:
- Job submission and tracking
- Job prioritization and scheduling
- Status monitoring and metrics
- Service health checks

```python
from accelerapp.cloud import CloudGenerationService

service = CloudGenerationService()
service.start()

# Submit a job
spec = {'device_name': 'My Device', 'platform': 'arduino'}
job_id = service.submit_job(spec, priority='high')

# Check status
status = service.get_job_status(job_id)
print(f"Job status: {status['status']}")
```

#### CloudAPIHandler
REST API endpoint infrastructure:
- Route registration and management
- Request handling with path parameters
- Built-in endpoints for jobs and health checks
- Extensible for custom endpoints

```python
from accelerapp.cloud import CloudAPIHandler
from accelerapp.cloud.api import HTTPMethod

api = CloudAPIHandler(service)
response = api.handle_request('/health', HTTPMethod.GET)
```

#### AuthenticationManager
Token-based authentication system:
- User management with roles
- Token generation and validation
- Permission checking
- Token expiration and revocation

```python
from accelerapp.cloud import AuthenticationManager

auth = AuthenticationManager()
auth.create_user('developer', 'password', roles=['user', 'developer'])

token = auth.authenticate('developer', 'password')
has_permission = auth.check_permission(token, 'developer')
```

#### JobQueue
Priority-based job queue:
- Automatic priority handling
- Worker thread management
- Concurrent job processing
- Job status tracking

```python
from accelerapp.cloud import JobQueue

queue = JobQueue(max_workers=4)

def process_job(job_data):
    # Process the job
    return {'status': 'completed'}

queue.enqueue('job1', {'data': 'test'}, priority='high')
queue.start_processing(process_job)
```

## Template Marketplace

Located in `src/accelerapp/marketplace/`

### Components

#### TemplateRegistry
Central registry for template management:
- Template registration and storage
- CRUD operations for templates
- Template versioning
- Statistics and metrics

```python
from accelerapp.marketplace import TemplateRegistry, TemplateMetadata, TemplatePackage

registry = TemplateRegistry()

# Create a template
metadata = TemplateMetadata(
    id='my-template',
    name='My Template',
    description='A great template',
    author='Me',
    version='1.0.0',
    category='embedded',
    tags=['arduino', 'led'],
    platforms=['arduino']
)

package = TemplatePackage(metadata)
package.add_file('main.cpp', '// Code here')

# Register it
registry.register_template(package)
```

#### TemplateSearch
Advanced search and filtering:
- Text search across name/description
- Category and platform filtering
- Tag-based filtering
- Rating and popularity sorting
- Most popular/top-rated queries

```python
from accelerapp.marketplace import TemplateSearch

search = TemplateSearch(registry.list_templates())

# Search for templates
results = search.search(
    query='led',
    category='embedded',
    platform='arduino',
    min_rating=4.0,
    sort_by='downloads'
)

# Get popular templates
popular = search.get_popular(limit=10)
```

## Visual Specification Builder

Located in `src/accelerapp/visual/`

### Components

#### VisualSpecification
Main specification container:
- Component management (add, remove, update)
- Connection tracking between components
- Position tracking for visual layout
- Validation system
- Import/export capabilities

```python
from accelerapp.visual import VisualSpecification

spec = VisualSpecification(
    name='LED Controller',
    description='Button-controlled LED'
)

# Add components
button_id = spec.add_component(
    'button',
    'Control Button',
    properties={'pin': 2},
    position={'x': 100, 'y': 200}
)

led_id = spec.add_component(
    'led',
    'Status LED',
    properties={'pin': 13},
    position={'x': 300, 'y': 200}
)

# Connect them
spec.add_connection(button_id, led_id)

# Validate
errors = spec.validate()
if not errors:
    print("Specification is valid!")
```

#### ComponentLibrary
Pre-built component definitions:
- Common hardware components (LED, button, sensor, motor)
- Communication components (serial, WiFi)
- Controller components (microcontroller)
- Categorized library
- Searchable components

```python
from accelerapp.visual import ComponentLibrary

library = ComponentLibrary()

# Get a component definition
led = library.get_component('led')
print(f"LED properties: {led.properties}")

# Search for components
results = library.search_components('motor')
```

#### SpecificationExporter
Export to multiple formats:
- JSON export
- YAML export
- Accelerapp configuration format
- Save/load from files

```python
from accelerapp.visual import SpecificationExporter
from pathlib import Path

exporter = SpecificationExporter(spec)

# Export to different formats
json_str = exporter.to_json()
yaml_str = exporter.to_yaml()
config = exporter.to_accelerapp_config()

# Save to files
exporter.save_json(Path('spec.json'))
exporter.save_yaml(Path('spec.yaml'))
exporter.save_accelerapp_config(Path('config.yaml'))
```

## Hardware-in-the-Loop Testing

Located in `src/accelerapp/hil/`

### Components

#### HILTestFramework
Main testing framework:
- Test case registration
- Test execution management
- Result collection and reporting
- Test summary generation

```python
from accelerapp.hil import HILTestFramework, TestCase

framework = HILTestFramework()

class MyTest(TestCase):
    def execute(self):
        # Test implementation
        self.assert_true(True, "Should pass")

framework.register_test(MyTest('test1', 'My Test'))
results = framework.run_all_tests()
```

#### TestCase
Base class for tests:
- Setup and teardown hooks
- Assertion methods (assert_equal, assert_true, assert_false)
- Automatic error handling
- Duration tracking

```python
class LEDTest(TestCase):
    def setup(self):
        # Initialize hardware
        pass
    
    def execute(self):
        # Test LED functionality
        self.assert_equal(value, expected_value)
    
    def teardown(self):
        # Clean up
        pass
```

#### HardwareInterface
Abstract hardware interface:
- Digital I/O operations
- Analog I/O operations
- Pin mode configuration
- Hardware reset

#### SimulatedHardware
Software simulation for testing:
- No physical hardware required
- Complete I/O simulation
- State tracking
- Perfect for CI/CD

```python
from accelerapp.hil.hardware import SimulatedHardware

hardware = SimulatedHardware()
hardware.connect()

# Simulate digital I/O
hardware.digital_write(13, True)
state = hardware.digital_read(13)  # Returns True

# Simulate analog I/O
hardware.analog_write(5, 512)
value = hardware.analog_read(5)  # Returns 512
```

#### TestRunner
Test execution and reporting:
- Run individual or all tests
- Verbose output mode
- JSON report generation
- HTML report generation

```python
from accelerapp.hil import TestRunner

runner = TestRunner(framework)

# Run tests with verbose output
report = runner.run_tests(verbose=True)

# Save reports
runner.save_report(Path('report.json'), 'json')
runner.save_report(Path('report.html'), 'html')

# Get summary
summary = report['summary']
print(f"Pass rate: {summary['pass_rate']:.1f}%")
```

## Running the Demo

A comprehensive demonstration script showcases all features:

```bash
python examples/v0.3.0_demo.py
```

The demo includes:
1. Cloud generation service with job submission and API
2. Template marketplace with registration and search
3. Visual specification building and export
4. HIL test execution and reporting
5. Authentication and authorization

## Testing

Comprehensive test suites are provided for all features:

```bash
# Run all tests
pytest tests/

# Run specific feature tests
pytest tests/test_cloud.py
pytest tests/test_marketplace.py
pytest tests/test_visual.py
pytest tests/test_hil.py
```

Test coverage:
- Cloud service: 23 tests
- Marketplace: 26 tests
- Visual builder: 22 tests
- HIL testing: 17 tests
- **Total new tests: 88**

## Future Development

These foundational modules can be extended with:

### Cloud Service
- Docker containerization
- Kubernetes orchestration
- Load balancing
- Auto-scaling
- Cloud storage integration
- Monitoring and alerting

### Template Marketplace
- Web-based UI
- User reviews and ratings
- Template previews
- Payment integration for premium templates
- Template analytics
- Dependency resolution

### Visual Specification Builder
- React/Vue drag-and-drop UI
- Real-time collaboration
- Version control integration
- Code preview
- Auto-save functionality
- Mobile/tablet support

### HIL Testing
- Physical hardware adapters for Arduino, STM32, ESP32
- Automated test generation
- Continuous integration support
- Test result visualization
- Coverage analysis
- Performance profiling

## Migration Guide

For existing v0.1.0 and v0.2.0 users:
- All existing features remain unchanged
- No breaking changes to existing APIs
- New features are optional and independent
- Can be adopted incrementally

## Support

For questions or issues:
- GitHub Issues: https://github.com/thewriterben/Accelerapp/issues
- Documentation: docs/
- Examples: examples/v0.3.0_demo.py
