// Auto-generated Arduino firmware
// Device: {{ device_name }}
// Generated by: Accelerapp Platform

#include <Arduino.h>
#include "config.h"

{% for peripheral in peripherals %}
// {{ peripheral.description | default('Peripheral') }}: {{ peripheral.type }}
{% endfor %}

void setup() {
    // Initialize serial communication
    Serial.begin({{ baud_rate | default(9600) }});
    Serial.println("{{ device_name }} starting...");
    
    {% for peripheral in peripherals %}
    // Initialize {{ peripheral.type }} on pin {{ peripheral.pin }}
    {% if peripheral.type == 'led' %}
    pinMode({{ peripheral.pin }}, OUTPUT);
    {% elif peripheral.type == 'button' %}
    pinMode({{ peripheral.pin }}, INPUT_PULLUP);
    {% elif peripheral.type == 'sensor' %}
    pinMode({{ peripheral.pin }}, INPUT);
    {% endif %}
    {% endfor %}
}

void loop() {
    {% for peripheral in peripherals %}
    {% if peripheral.type == 'sensor' %}
    // Read sensor on pin {{ peripheral.pin }}
    int {{ peripheral.type }}_value = analogRead({{ peripheral.pin }});
    Serial.print("Sensor: ");
    Serial.println({{ peripheral.type }}_value);
    {% elif peripheral.type == 'led' %}
    // Blink LED on pin {{ peripheral.pin }}
    digitalWrite({{ peripheral.pin }}, HIGH);
    delay(500);
    digitalWrite({{ peripheral.pin }}, LOW);
    delay(500);
    {% endif %}
    {% endfor %}
    
    delay(100);
}
